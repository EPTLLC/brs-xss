# BRS-XSS v2.0.0 Configuration  
# ==================================
# Default settings for the scanner.
# For user-specific overrides, create a `config.toml` in `~/.config/brs-xss/`.

# General scanner settings
scanner:
  # Number of concurrent requests
  concurrency: 32

  # Global rate limit in requests per second (RPS)
  rate_limit: 8.0

  # Request timeout in seconds
  timeout: 15

  # Scanner version (for reporting)
  version: "2.0.0"

  # Max crawl depth for parameter discovery
  max_depth: 3
  
  # User agent string
  user_agent: "BRS-XSS v2.0.0"

  # Enable safe mode for production environments (disables risky payloads)
  safe_mode: true

  # Respect robots.txt
  respect_robots: true
  # Enable URL denylist
  enable_denylist: true
  # HTTP retry attempts
  max_retries: 3
  # Exponential backoff multiplier
  backoff_factor: 2.0

# Performance and caching
performance:
  enable_caching: true            # Enable reflection caching
  cache_size: 10000               # Max cached URL+parameter combinations
  enable_deduplication: true      # Enable payload deduplication via Bloom filter
  bloom_filter_size: 100000       # Bloom filter capacity
  bloom_error_rate: 0.01          # Bloom filter false positive rate
  browser_pool_size: 4            # Playwright browser instances per worker
  
# Payload settings
payloads:
  max_generation: 1000
  min_efficiency: 85
  contexts: ["html", "attribute", "script", "css", "uri", "svg"]
  aggr_mode: false                # Enable aggressive polyglot + multi-encoding
  waf_bypass: true                # Include WAF bypass payloads
  
# Machine learning
ml:
  models_path: "./brsxss/ml/models/"
  enable_prediction: true
  confidence_threshold: 0.8
  context_features: 76            # HTML/JS features (32 sources + 44 sinks)
  payload_features: 24            # Payload characteristics

# Reporting with SARIF 2.1.0 compliance
reporting:
  formats: ["sarif", "json", "html"]
  output_dir: "./results/"
  include_screenshots: true       # For DOM XSS analysis
  include_replay_urls: true       # One-click vulnerability replay
  auto_cleanup_days: 30
  preserve_critical: true
  sarif_version: "2.1.0"
  json_schema_validation: true
  
# Internationalization  
i18n:
  locales_path: "./brsxss/i18n/locales/"
  supported_locales: ["en", "ru"]
  auto_detect_locale: false       # Disable auto-detection for consistency
  domain: "brsxss"

# HTTP settings with security focus
http:
  verify_ssl: true
  follow_redirects: true
  max_redirects: 5
  default_headers:
    Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8"
    Accept-Language: "en-US,en;q=0.9"
    Accept-Encoding: "gzip, deflate"
    Connection: "keep-alive"
    Cache-Control: "no-cache"

# Security and safety
security:
  denylist_domains: []            # Domains to never scan
  denylist_patterns: []           # URL patterns to avoid
  max_payload_length: 2048        # Maximum payload size
  sanitize_logs: true             # Sanitize sensitive data in logs
  enable_safe_logging: true       # Use PayloadValidator for log sanitization

# Logging with structured output
logging:
  level: "INFO"
  console_output: true
  file_output: "./logs/brs-xss.log"
  format: "%(asctime)s | %(levelname)-8s | %(name)s | %(message)s"
  max_log_size: "100MB"
  backup_count: 5